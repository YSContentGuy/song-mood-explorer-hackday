<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Web Console (Restricted)</title>
  <style>
    body { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace; background:#0b1020; color:#d7dbff; margin:0; padding:16px; }
    .wrap { max-width: 1100px; margin: 0 auto; }
    .row { display:flex; gap:8px; align-items:center; }
    select, button { background:#121a36; color:#d7dbff; border:1px solid #263166; border-radius:8px; padding:8px; }
    button { cursor:pointer; }
    pre { background:#0e1530; border:1px solid #1c2754; border-radius:8px; padding:12px; white-space:pre-wrap; word-break:break-word; }
    .muted { color:#8aa0ff; font-size:12px; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="row">
      <select id="preset"></select>
      <button id="run">Run</button>
      <span class="muted">Restricted presets only.</span>
    </div>
    <div id="out" class="row" style="margin-top:12px;"><pre id="pre">Loading presets…</pre></div>
  </div>
  <script>
    async function loadPresets(){
      const res = await fetch('/api/admin/presets');
      const data = await res.json();
      const sel = document.getElementById('preset');
      sel.innerHTML = '';
      (data.presets||[]).forEach(p => {
        const o = document.createElement('option');
        o.value = p.key; o.textContent = p.label; sel.appendChild(o);
      });
      document.getElementById('pre').textContent = 'Ready. Choose a preset and Run.';
    }
    async function run(){
      const key = document.getElementById('preset').value;
      const pre = document.getElementById('pre');
      pre.textContent = 'Running ' + key + '…';
      const res = await fetch('/api/admin/exec', { method: 'POST', headers: { 'Content-Type':'application/json' }, body: JSON.stringify({ preset: key }) });
      const data = await res.json();
      pre.textContent = `$ ${data.cmd}\n\n` + (data.stdout||'') + (data.stderr ? ('\n[stderr]\n'+data.stderr) : '');
    }
    document.getElementById('run').onclick = run;
    loadPresets();
  </script>
</body>
</html>